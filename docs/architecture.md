# ============================================================================
# MASASIA - System Architecture
# ============================================================================
# Version: 1.0
# ============================================================================

# =============================================================================
# 1. HIGH-LEVEL ARCHITECTURE
# =============================================================================

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          MASASIA SYSTEM ARCHITECTURE                            │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                              CLIENTS                                     │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                         │   │
│  │   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐                  │   │
│  │   │  Customer   │   │  Provider   │   │   Admin     │                  │   │
│  │   │    App      │   │    App      │   │    Web      │                  │   │
│  │   │ (React Native)  │ (React Native)  │  (React)    │                  │   │
│  │   │ iOS/Android │   │ iOS/Android │   │             │                  │   │
│  │   └──────┬──────┘   └──────┬──────┘   └──────┬──────┘                  │   │
│  │          │                 │                 │                          │   │
│  └──────────┼─────────────────┼─────────────────┼──────────────────────────┘   │
│             │                 │                 │                               │
│             │    HTTPS/WSS    │                 │                               │
│             ▼                 ▼                 ▼                               │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                          AWS CLOUD                                       │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                         │   │
│  │   ┌─────────────────────────────────────────────────────────────────┐  │   │
│  │   │                    APPLICATION LOAD BALANCER                     │  │   │
│  │   │                         (ALB + SSL)                              │  │   │
│  │   └────────────────────────────┬────────────────────────────────────┘  │   │
│  │                                │                                        │   │
│  │                                ▼                                        │   │
│  │   ┌─────────────────────────────────────────────────────────────────┐  │   │
│  │   │                     ECS FARGATE CLUSTER                          │  │   │
│  │   ├─────────────────────────────────────────────────────────────────┤  │   │
│  │   │                                                                 │  │   │
│  │   │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │  │   │
│  │   │  │   API Service   │  │ Socket Service  │  │  Worker Service │ │  │   │
│  │   │  │   (Node.js)     │  │   (Socket.IO)   │  │   (Node.js)     │ │  │   │
│  │   │  │                 │  │                 │  │                 │ │  │   │
│  │   │  │ - REST API      │  │ - Real-time     │  │ - Background    │ │  │   │
│  │   │  │ - Auth          │  │ - Location      │  │ - Scheduled     │ │  │   │
│  │   │  │ - Business      │  │ - Notifications │  │ - Notifications │ │  │   │
│  │   │  │   Logic         │  │ - Chat          │  │ - Settlements   │ │  │   │
│  │   │  └────────┬────────┘  └────────┬────────┘  └────────┬────────┘ │  │   │
│  │   │           │                    │                    │          │  │   │
│  │   └───────────┼────────────────────┼────────────────────┼──────────┘  │   │
│  │               │                    │                    │              │   │
│  │               ▼                    ▼                    ▼              │   │
│  │   ┌─────────────────────────────────────────────────────────────────┐  │   │
│  │   │                       DATA LAYER                                 │  │   │
│  │   ├─────────────────────────────────────────────────────────────────┤  │   │
│  │   │                                                                 │  │   │
│  │   │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │  │   │
│  │   │  │      RDS        │  │   ElastiCache   │  │       S3        │ │  │   │
│  │   │  │   PostgreSQL    │  │     Redis       │  │                 │ │  │   │
│  │   │  │                 │  │                 │  │ - Images        │ │  │   │
│  │   │  │ - Users         │  │ - Session       │  │ - Documents     │ │  │   │
│  │   │  │ - Bookings      │  │ - Cache         │  │ - Files         │ │  │   │
│  │   │  │ - Payments      │  │ - Real-time     │  │                 │ │  │   │
│  │   │  │ - etc.          │  │   Location      │  │                 │ │  │   │
│  │   │  └─────────────────┘  └─────────────────┘  └─────────────────┘ │  │   │
│  │   │                                                                 │  │   │
│  │   └─────────────────────────────────────────────────────────────────┘  │   │
│  │                                                                         │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        EXTERNAL SERVICES                                 │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                         │   │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐     │   │
│  │  │ PayMongo │ │  Google  │ │ Firebase │ │  Twilio  │ │ SendGrid │     │   │
│  │  │          │ │   Maps   │ │   FCM    │ │   SMS    │ │  Email   │     │   │
│  │  │ Payment  │ │ Location │ │   Push   │ │          │ │          │     │   │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘     │   │
│  │                                                                         │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

# =============================================================================
# 2. DETAILED COMPONENT DIAGRAM
# =============================================================================

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         BACKEND SERVICE ARCHITECTURE                            │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                         API SERVICE (Express.js)                         │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                         │   │
│  │  ┌───────────────────────────────────────────────────────────────────┐ │   │
│  │  │                          MIDDLEWARE                                │ │   │
│  │  ├───────────────────────────────────────────────────────────────────┤ │   │
│  │  │ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐     │ │   │
│  │  │ │  CORS   │ │ Helmet  │ │  Rate   │ │  Auth   │ │  Error  │     │ │   │
│  │  │ │         │ │         │ │ Limiter │ │  JWT    │ │ Handler │     │ │   │
│  │  │ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘     │ │   │
│  │  └───────────────────────────────────────────────────────────────────┘ │   │
│  │                                                                         │   │
│  │  ┌───────────────────────────────────────────────────────────────────┐ │   │
│  │  │                           ROUTES                                   │ │   │
│  │  ├───────────────────────────────────────────────────────────────────┤ │   │
│  │  │ /auth    /users    /providers    /bookings    /payments    /admin │ │   │
│  │  └───────────────────────────────────────────────────────────────────┘ │   │
│  │                                    │                                    │   │
│  │                                    ▼                                    │   │
│  │  ┌───────────────────────────────────────────────────────────────────┐ │   │
│  │  │                         CONTROLLERS                                │ │   │
│  │  ├───────────────────────────────────────────────────────────────────┤ │   │
│  │  │ AuthController    UserController    ProviderController            │ │   │
│  │  │ BookingController    PaymentController    AdminController         │ │   │
│  │  └───────────────────────────────────────────────────────────────────┘ │   │
│  │                                    │                                    │   │
│  │                                    ▼                                    │   │
│  │  ┌───────────────────────────────────────────────────────────────────┐ │   │
│  │  │                          SERVICES                                  │ │   │
│  │  ├───────────────────────────────────────────────────────────────────┤ │   │
│  │  │ AuthService     UserService      ProviderService                  │ │   │
│  │  │ BookingService  PaymentService   NotificationService              │ │   │
│  │  │ LocationService PayoutService    ReviewService                    │ │   │
│  │  └───────────────────────────────────────────────────────────────────┘ │   │
│  │                                    │                                    │   │
│  │                                    ▼                                    │   │
│  │  ┌───────────────────────────────────────────────────────────────────┐ │   │
│  │  │                        DATA ACCESS                                 │ │   │
│  │  ├───────────────────────────────────────────────────────────────────┤ │   │
│  │  │              Prisma Client (ORM)                                  │ │   │
│  │  │              Redis Client (Cache)                                 │ │   │
│  │  └───────────────────────────────────────────────────────────────────┘ │   │
│  │                                                                         │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

# =============================================================================
# 3. REAL-TIME LOCATION TRACKING FLOW
# =============================================================================

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                      REAL-TIME LOCATION TRACKING FLOW                           │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  Provider App                    Server                         Customer App   │
│       │                            │                                  │        │
│       │  1. 예약 수락              │                                  │        │
│       │ ─────────────────────────> │                                  │        │
│       │                            │                                  │        │
│       │                            │  2. 예약 상태 변경 푸시          │        │
│       │                            │ ─────────────────────────────────>│        │
│       │                            │                                  │        │
│       │  3. 이동 시작 (EN_ROUTE)   │                                  │        │
│       │ ─────────────────────────> │                                  │        │
│       │                            │                                  │        │
│       │                            │  4. 상태 + ETA 푸시              │        │
│       │                            │ ─────────────────────────────────>│        │
│       │                            │                                  │        │
│       │  5. WebSocket 연결         │        6. WebSocket 연결         │        │
│       │ <========================> │ <==============================> │        │
│       │                            │                                  │        │
│       │                            │                                  │        │
│  ┌────┴────┐                  ┌────┴────┐                        ┌────┴────┐   │
│  │ 3~5초마다│                  │  Redis  │                        │ 실시간   │   │
│  │ GPS 전송 │ ───────────────> │ 위치저장│ ─────────────────────> │ 지도표시 │   │
│  └────┬────┘                  └────┬────┘                        └────┬────┘   │
│       │                            │                                  │        │
│       │  7. 위치 업데이트          │                                  │        │
│       │     (lat, lng, accuracy)   │                                  │        │
│       │ =========================> │                                  │        │
│       │                            │                                  │        │
│       │                            │  8. 마스킹된 위치 브로드캐스트   │        │
│       │                            │     (50~100m 반올림)            │        │
│       │                            │     + ETA (Google Maps API)     │        │
│       │                            │ ===============================> │        │
│       │                            │                                  │        │
│       │  9. 도착                   │                                  │        │
│       │ ─────────────────────────> │                                  │        │
│       │                            │                                  │        │
│       │                            │  10. 도착 알림                   │        │
│       │                            │ ─────────────────────────────────>│        │
│       │                            │                                  │        │
│                                                                                 │
│  Legend:                                                                        │
│  ───────>  HTTP Request                                                        │
│  =======>  WebSocket (Socket.IO)                                               │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

# =============================================================================
# 4. BOOKING FLOW
# =============================================================================

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              BOOKING FLOW                                       │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  Customer                Server                  Provider              External │
│     │                      │                        │                      │   │
│     │  1. 예약 생성        │                        │                      │   │
│     │  (provider, service, │                        │                      │   │
│     │   datetime, address) │                        │                      │   │
│     │ ────────────────────>│                        │                      │   │
│     │                      │                        │                      │   │
│     │                      │  2. 금액 계산          │                      │   │
│     │                      │     (service + travel) │                      │   │
│     │                      │                        │                      │   │
│     │                      │  3. Payment Intent 생성│                      │   │
│     │                      │ ───────────────────────────────────────────> │   │
│     │                      │                        │              PayMongo│   │
│     │  4. client_key       │                        │                      │   │
│     │ <────────────────────│                        │                      │   │
│     │                      │                        │                      │   │
│     │  5. 결제 진행        │                        │                      │   │
│     │     (앱 내 결제 UI)  │                        │                      │   │
│     │ ───────────────────────────────────────────────────────────────────>│   │
│     │                      │                        │                      │   │
│     │                      │  6. Webhook: 결제 완료 │                      │   │
│     │                      │ <───────────────────────────────────────────│   │
│     │                      │                        │                      │   │
│     │                      │  7. 예약 상태 변경     │                      │   │
│     │                      │     (PENDING)          │                      │   │
│     │                      │                        │                      │   │
│     │                      │  8. 푸시 알림          │                      │   │
│     │                      │ ───────────────────────>│                      │   │
│     │                      │                        │                      │   │
│     │                      │                        │  9. 예약 수락/거절   │   │
│     │                      │ <───────────────────────│                      │   │
│     │                      │                        │                      │   │
│     │  10. 결과 푸시       │                        │                      │   │
│     │ <────────────────────│                        │                      │   │
│     │                      │                        │                      │   │
│     │                      │                        │                      │   │
│     │                   ┌──┴──┐                     │                      │   │
│     │                   │수락됨│                     │                      │   │
│     │                   └──┬──┘                     │                      │   │
│     │                      │                        │                      │   │
│     │                      │  11. 이동 시작         │                      │   │
│     │                      │ <───────────────────────│                      │   │
│     │                      │                        │                      │   │
│     │  12. 실시간 추적     │  13. 위치 업데이트     │                      │   │
│     │ <════════════════════════════════════════════│                      │   │
│     │                      │                        │                      │   │
│     │                      │  14. 도착              │                      │   │
│     │                      │ <───────────────────────│                      │   │
│     │                      │                        │                      │   │
│     │                      │  15. 서비스 시작       │                      │   │
│     │                      │ <───────────────────────│                      │   │
│     │                      │                        │                      │   │
│     │                      │  16. 서비스 완료       │                      │   │
│     │                      │ <───────────────────────│                      │   │
│     │                      │                        │                      │   │
│     │                      │  17. 프로바이더 수익   │                      │   │
│     │                      │      잔액 추가         │                      │   │
│     │                      │                        │                      │   │
│     │  18. 완료 + 리뷰요청 │                        │                      │   │
│     │ <────────────────────│                        │                      │   │
│     │                      │                        │                      │   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

# =============================================================================
# 5. PAYMENT FLOW (PayMongo)
# =============================================================================

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           PAYMENT FLOW (PayMongo)                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  Customer App              Backend                            PayMongo         │
│       │                      │                                    │            │
│       │                      │                                    │            │
│       │  1. 예약 + 결제 요청 │                                    │            │
│       │ ────────────────────>│                                    │            │
│       │                      │                                    │            │
│       │                      │  2. Create Payment Intent          │            │
│       │                      │     POST /v1/payment_intents       │            │
│       │                      │     {amount, currency,             │            │
│       │                      │      payment_method_allowed}       │            │
│       │                      │ ──────────────────────────────────>│            │
│       │                      │                                    │            │
│       │                      │  3. Payment Intent Created         │            │
│       │                      │     {id, client_key, status}       │            │
│       │                      │ <──────────────────────────────────│            │
│       │                      │                                    │            │
│       │  4. Return client_key│                                    │            │
│       │ <────────────────────│                                    │            │
│       │                      │                                    │            │
│       │                                                           │            │
│       │  5. 결제 수단 선택 (카드/GCash/PayMaya)                   │            │
│       │     PayMongo JS SDK로 결제 처리                           │            │
│       │ ─────────────────────────────────────────────────────────>│            │
│       │                                                           │            │
│       │                                                           │            │
│       │  6. 결제 결과 (redirect 또는 callback)                    │            │
│       │ <─────────────────────────────────────────────────────────│            │
│       │                                                           │            │
│       │                      │                                    │            │
│       │                      │  7. Webhook: payment.paid          │            │
│       │                      │     POST /api/payments/webhook     │            │
│       │                      │ <──────────────────────────────────│            │
│       │                      │                                    │            │
│       │                      │  8. 예약 확정                      │            │
│       │                      │     - Payment status: COMPLETED    │            │
│       │                      │     - Booking status: PENDING      │            │
│       │                      │     - 프로바이더에게 푸시          │            │
│       │                      │                                    │            │
│       │  9. 결제 완료 화면   │                                    │            │
│       │ <────────────────────│                                    │            │
│       │                      │                                    │            │
│                                                                                 │
│  ═══════════════════════════════════════════════════════════════════════════   │
│                                                                                 │
│  REFUND FLOW (환불)                                                            │
│                                                                                 │
│       │                      │                                    │            │
│       │  취소 요청           │                                    │            │
│       │ ────────────────────>│                                    │            │
│       │                      │                                    │            │
│       │                      │  환불 정책 확인                    │            │
│       │                      │  (24시간 전: 100%, 12시간: 70%...) │            │
│       │                      │                                    │            │
│       │                      │  Create Refund                     │            │
│       │                      │  POST /v1/refunds                  │            │
│       │                      │  {payment_id, amount, reason}      │            │
│       │                      │ ──────────────────────────────────>│            │
│       │                      │                                    │            │
│       │                      │  Refund Created                    │            │
│       │                      │ <──────────────────────────────────│            │
│       │                      │                                    │            │
│       │  환불 완료           │                                    │            │
│       │ <────────────────────│                                    │            │
│       │                      │                                    │            │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

# =============================================================================
# 6. SOCKET.IO EVENTS
# =============================================================================

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                             SOCKET.IO EVENTS                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  CLIENT -> SERVER (Emit)                                                        │
│  ─────────────────────────────────────────────────────────────────────────────  │
│                                                                                 │
│  ┌─────────────────────────┬───────────────────────────────────────────────┐   │
│  │ Event                   │ Payload                                       │   │
│  ├─────────────────────────┼───────────────────────────────────────────────┤   │
│  │ authenticate            │ { token: string }                             │   │
│  │ join:booking            │ { bookingId: string }                         │   │
│  │ leave:booking           │ { bookingId: string }                         │   │
│  │ location:update         │ { bookingId, lat, lng, accuracy }             │   │
│  │ provider:status         │ { status: 'ONLINE' | 'OFFLINE' }              │   │
│  └─────────────────────────┴───────────────────────────────────────────────┘   │
│                                                                                 │
│  SERVER -> CLIENT (Emit)                                                        │
│  ─────────────────────────────────────────────────────────────────────────────  │
│                                                                                 │
│  ┌─────────────────────────┬───────────────────────────────────────────────┐   │
│  │ Event                   │ Payload                                       │   │
│  ├─────────────────────────┼───────────────────────────────────────────────┤   │
│  │ authenticated           │ { success: boolean, userId: string }          │   │
│  │ booking:new             │ { booking: BookingData }                       │   │
│  │ booking:updated         │ { bookingId, status, ... }                     │   │
│  │ booking:cancelled       │ { bookingId, reason }                          │   │
│  │ location:provider       │ { bookingId, lat, lng, eta }                   │   │
│  │ notification            │ { type, title, body, data }                    │   │
│  │ error                   │ { code, message }                              │   │
│  └─────────────────────────┴───────────────────────────────────────────────┘   │
│                                                                                 │
│  ROOMS                                                                          │
│  ─────────────────────────────────────────────────────────────────────────────  │
│                                                                                 │
│  • user:{userId}           - 사용자별 개인 룸 (알림)                           │
│  • booking:{bookingId}     - 예약별 룸 (실시간 추적)                           │
│  • provider:online         - 온라인 프로바이더 룸                              │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

# =============================================================================
# 7. AWS INFRASTRUCTURE
# =============================================================================

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            AWS INFRASTRUCTURE                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                              VPC (10.0.0.0/16)                            │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                         │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                    PUBLIC SUBNETS (10.0.1.0/24, 10.0.2.0/24)     │   │   │
│  │  ├─────────────────────────────────────────────────────────────────┤   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────────┐    ┌─────────────────┐                    │   │   │
│  │  │  │   NAT Gateway   │    │ Application LB  │                    │   │   │
│  │  │  │   (AZ-a)        │    │ (Internet-facing)│                    │   │   │
│  │  │  └─────────────────┘    └─────────────────┘                    │   │   │
│  │  │                                                                 │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │
│  │                                    │                                    │   │
│  │                                    ▼                                    │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                   PRIVATE SUBNETS (10.0.3.0/24, 10.0.4.0/24)    │   │   │
│  │  ├─────────────────────────────────────────────────────────────────┤   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────────────────────────────────────────────────┐   │   │   │
│  │  │  │                    ECS FARGATE CLUSTER                   │   │   │   │
│  │  │  ├─────────────────────────────────────────────────────────┤   │   │   │
│  │  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │   │   │   │
│  │  │  │  │ API Service │  │Socket Service│  │Worker Service│     │   │   │   │
│  │  │  │  │  Task x2    │  │  Task x2    │  │  Task x1    │     │   │   │   │
│  │  │  │  │  256 CPU    │  │  256 CPU    │  │  256 CPU    │     │   │   │   │
│  │  │  │  │  512 MEM    │  │  512 MEM    │  │  512 MEM    │     │   │   │   │
│  │  │  │  └─────────────┘  └─────────────┘  └─────────────┘     │   │   │   │
│  │  │  └─────────────────────────────────────────────────────────┘   │   │   │
│  │  │                                                                 │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │
│  │                                    │                                    │   │
│  │                                    ▼                                    │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                  DATABASE SUBNETS (10.0.5.0/24, 10.0.6.0/24)    │   │   │
│  │  ├─────────────────────────────────────────────────────────────────┤   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────────┐    ┌─────────────────┐                    │   │   │
│  │  │  │  RDS PostgreSQL │    │   ElastiCache   │                    │   │   │
│  │  │  │  db.t3.small    │    │   Redis         │                    │   │   │
│  │  │  │  Multi-AZ       │    │   cache.t3.micro│                    │   │   │
│  │  │  └─────────────────┘    └─────────────────┘                    │   │   │
│  │  │                                                                 │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │
│  │                                                                         │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  OTHER AWS SERVICES                                                            │
│  ─────────────────────────────────────────────────────────────────────────────  │
│                                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐           │
│  │     S3      │  │ CloudFront  │  │  CloudWatch │  │   Secrets   │           │
│  │  (Storage)  │  │   (CDN)     │  │   (Logs)    │  │   Manager   │           │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘           │
│                                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                            │
│  │     ECR     │  │   Route53   │  │     ACM     │                            │
│  │  (Registry) │  │   (DNS)     │  │   (SSL)     │                            │
│  └─────────────┘  └─────────────┘  └─────────────┘                            │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

# =============================================================================
# 8. FOLDER STRUCTURE
# =============================================================================

```
masasia/
├── apps/
│   ├── api/                          # Backend API (Node.js/Express)
│   │   ├── src/
│   │   │   ├── config/               # Configuration
│   │   │   │   ├── database.ts
│   │   │   │   ├── redis.ts
│   │   │   │   ├── aws.ts
│   │   │   │   └── index.ts
│   │   │   ├── middleware/           # Express middleware
│   │   │   │   ├── auth.ts
│   │   │   │   ├── errorHandler.ts
│   │   │   │   ├── rateLimiter.ts
│   │   │   │   └── validate.ts
│   │   │   ├── routes/               # API routes
│   │   │   │   ├── auth.routes.ts
│   │   │   │   ├── users.routes.ts
│   │   │   │   ├── providers.routes.ts
│   │   │   │   ├── bookings.routes.ts
│   │   │   │   ├── payments.routes.ts
│   │   │   │   ├── reviews.routes.ts
│   │   │   │   ├── reports.routes.ts
│   │   │   │   ├── notifications.routes.ts
│   │   │   │   ├── admin.routes.ts
│   │   │   │   └── index.ts
│   │   │   ├── controllers/          # Route controllers
│   │   │   │   ├── auth.controller.ts
│   │   │   │   ├── users.controller.ts
│   │   │   │   ├── providers.controller.ts
│   │   │   │   ├── bookings.controller.ts
│   │   │   │   ├── payments.controller.ts
│   │   │   │   └── ...
│   │   │   ├── services/             # Business logic
│   │   │   │   ├── auth.service.ts
│   │   │   │   ├── users.service.ts
│   │   │   │   ├── providers.service.ts
│   │   │   │   ├── bookings.service.ts
│   │   │   │   ├── payments.service.ts
│   │   │   │   ├── notification.service.ts
│   │   │   │   ├── location.service.ts
│   │   │   │   ├── payout.service.ts
│   │   │   │   └── ...
│   │   │   ├── utils/                # Utilities
│   │   │   │   ├── jwt.ts
│   │   │   │   ├── hash.ts
│   │   │   │   ├── sms.ts
│   │   │   │   ├── email.ts
│   │   │   │   ├── push.ts
│   │   │   │   ├── maps.ts
│   │   │   │   └── ...
│   │   │   ├── validators/           # Input validation (Zod)
│   │   │   │   ├── auth.validator.ts
│   │   │   │   ├── booking.validator.ts
│   │   │   │   └── ...
│   │   │   ├── types/                # TypeScript types
│   │   │   │   └── index.ts
│   │   │   ├── socket/               # Socket.IO handlers
│   │   │   │   ├── index.ts
│   │   │   │   ├── auth.handler.ts
│   │   │   │   ├── booking.handler.ts
│   │   │   │   └── location.handler.ts
│   │   │   └── app.ts                # Express app setup
│   │   ├── prisma/
│   │   │   ├── schema.prisma
│   │   │   ├── migrations/
│   │   │   └── seed.ts
│   │   ├── tests/
│   │   ├── Dockerfile
│   │   ├── package.json
│   │   └── tsconfig.json
│   │
│   ├── customer-app/                 # Customer Mobile App (React Native)
│   │   ├── src/
│   │   │   ├── screens/
│   │   │   │   ├── Auth/
│   │   │   │   ├── Home/
│   │   │   │   ├── Search/
│   │   │   │   ├── Provider/
│   │   │   │   ├── Booking/
│   │   │   │   ├── Tracking/
│   │   │   │   ├── History/
│   │   │   │   └── Profile/
│   │   │   ├── components/
│   │   │   ├── navigation/
│   │   │   ├── hooks/
│   │   │   ├── services/
│   │   │   ├── store/
│   │   │   ├── utils/
│   │   │   └── types/
│   │   ├── ios/
│   │   ├── android/
│   │   └── package.json
│   │
│   ├── provider-app/                 # Provider Mobile App (React Native)
│   │   ├── src/
│   │   │   ├── screens/
│   │   │   │   ├── Auth/
│   │   │   │   ├── Registration/
│   │   │   │   ├── Dashboard/
│   │   │   │   ├── Booking/
│   │   │   │   ├── Earnings/
│   │   │   │   └── Settings/
│   │   │   ├── components/
│   │   │   ├── navigation/
│   │   │   ├── hooks/
│   │   │   ├── services/
│   │   │   ├── store/
│   │   │   └── utils/
│   │   ├── ios/
│   │   ├── android/
│   │   └── package.json
│   │
│   └── admin-web/                    # Admin Web (React)
│       ├── src/
│       │   ├── pages/
│       │   │   ├── Dashboard/
│       │   │   ├── Providers/
│       │   │   ├── Bookings/
│       │   │   ├── Payouts/
│       │   │   ├── Reports/
│       │   │   └── Settings/
│       │   ├── components/
│       │   ├── hooks/
│       │   ├── services/
│       │   └── utils/
│       └── package.json
│
├── packages/                         # Shared packages
│   ├── shared-types/                 # Shared TypeScript types
│   └── shared-utils/                 # Shared utilities
│
├── infrastructure/                   # Infrastructure as Code
│   ├── terraform/
│   │   ├── modules/
│   │   │   ├── vpc/
│   │   │   ├── ecs/
│   │   │   ├── rds/
│   │   │   ├── elasticache/
│   │   │   └── s3/
│   │   ├── environments/
│   │   │   ├── dev/
│   │   │   ├── staging/
│   │   │   └── prod/
│   │   └── main.tf
│   └── docker/
│       └── docker-compose.yml
│
├── docs/                             # Documentation
│   ├── api/
│   ├── architecture/
│   └── deployment/
│
├── .github/                          # GitHub Actions
│   └── workflows/
│       ├── api-deploy.yml
│       ├── app-build.yml
│       └── admin-deploy.yml
│
├── package.json                      # Root package.json (monorepo)
├── turbo.json                        # Turborepo config
└── README.md
```

# =============================================================================
# 9. TECHNOLOGY STACK SUMMARY
# =============================================================================

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           TECHNOLOGY STACK                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  FRONTEND (Mobile)                                                             │
│  ─────────────────────────────────────────────────────────────────────────────  │
│  • React Native 0.73+                                                          │
│  • TypeScript 5.0+                                                             │
│  • React Navigation 6                                                          │
│  • Zustand (State Management)                                                  │
│  • React Query / TanStack Query                                                │
│  • Socket.IO Client                                                            │
│  • React Native Maps                                                           │
│  • React Native Reanimated                                                     │
│                                                                                 │
│  FRONTEND (Admin Web)                                                          │
│  ─────────────────────────────────────────────────────────────────────────────  │
│  • React 18                                                                    │
│  • TypeScript 5.0+                                                             │
│  • Vite                                                                        │
│  • Tailwind CSS                                                                │
│  • shadcn/ui                                                                   │
│  • React Router 6                                                              │
│  • React Query                                                                 │
│                                                                                 │
│  BACKEND                                                                        │
│  ─────────────────────────────────────────────────────────────────────────────  │
│  • Node.js 20 LTS                                                              │
│  • Express.js 4.18+                                                            │
│  • TypeScript 5.0+                                                             │
│  • Prisma ORM 5.0+                                                             │
│  • Socket.IO 4.6+                                                              │
│  • Zod (Validation)                                                            │
│  • JWT (jsonwebtoken)                                                          │
│  • bcryptjs                                                                    │
│                                                                                 │
│  DATABASE & CACHE                                                               │
│  ─────────────────────────────────────────────────────────────────────────────  │
│  • PostgreSQL 15                                                               │
│  • Redis 7                                                                     │
│                                                                                 │
│  CLOUD (AWS)                                                                    │
│  ─────────────────────────────────────────────────────────────────────────────  │
│  • ECS Fargate (Container)                                                     │
│  • RDS PostgreSQL                                                              │
│  • ElastiCache Redis                                                           │
│  • S3 (Storage)                                                                │
│  • CloudFront (CDN)                                                            │
│  • ALB (Load Balancer)                                                         │
│  • Route53 (DNS)                                                               │
│  • ACM (SSL)                                                                   │
│  • CloudWatch (Monitoring)                                                     │
│  • Secrets Manager                                                             │
│                                                                                 │
│  EXTERNAL SERVICES                                                              │
│  ─────────────────────────────────────────────────────────────────────────────  │
│  • PayMongo (Payment)                                                          │
│  • Google Maps API (Location, ETA)                                             │
│  • Firebase Cloud Messaging (Push)                                             │
│  • Twilio (SMS)                                                                │
│  • SendGrid / AWS SES (Email)                                                  │
│                                                                                 │
│  DEVOPS                                                                         │
│  ─────────────────────────────────────────────────────────────────────────────  │
│  • GitHub Actions (CI/CD)                                                      │
│  • Docker                                                                      │
│  • Terraform (IaC)                                                             │
│  • Turborepo (Monorepo)                                                        │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```
